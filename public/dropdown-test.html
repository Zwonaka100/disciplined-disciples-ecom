<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Dropdown Test - Disciplined Disciples</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="profile-avatar-fix.css">
    <script src="https://kit.fontawesome.com/88ee0ca59c.js" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container flex justify-between items-center py-4">
            <a href="index.html" class="logo flex items-center">
                <img src="Assets/logo.jpg" alt="Disciplined Disciples Logo" class="site-logo" style="height:40px; width:auto; margin-right:10px;">
                <span>Disciplined Disciples</span>
            </a>
            <nav class="nav-menu">
                <ul class="flex space-x-6">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="shop.html" class="nav-link">Shop</a></li>
                    <li><a href="blog.html" class="nav-link">Blog</a></li>
                    <li><a href="contact.html" class="nav-link">Contact</a></li>
                    <li><a href="cart.html" class="nav-link"><i class="fas fa-shopping-cart"></i></a></li>
                </ul>
                <a href="login-signup.html" id="login-signup-link" class="nav-link"><i class="fas fa-sign-in-alt"></i> Login/Signup</a>
                <div id="profile-ribbon" class="relative flex items-center space-x-2 cursor-pointer select-none" style="display:block;">
                    <span id="profile-ribbon-name" class="font-semibold text-gray-700">Test User</span>
                    <div id="profile-ribbon-avatar" class="w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-700 font-bold text-lg border-2 border-gray-300 overflow-hidden">T</div>
                    <div id="profile-dropdown" class="absolute right-0 top-12 bg-white border rounded shadow-lg min-w-[160px] hidden z-50">
                        <a href="profile.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-user mr-2"></i>Profile
                        </a>
                        <a href="profile.html#account" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-user-cog mr-2"></i>Account
                        </a>
                        <a href="profile.html#orders" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-shopping-bag mr-2"></i>Orders
                        </a>
                        <button id="dropdown-logout-btn" class="w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="container mx-auto py-8">
        <div class="bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold mb-4">Profile Dropdown Test</h1>
            <div class="space-y-4">
                <p>This page tests the profile dropdown functionality.</p>
                <p>Current user: <span id="current-user-info">Not logged in</span></p>
                <p>Dropdown status: <span id="dropdown-status">Hidden</span></p>
                
                <div class="mt-6 space-y-4">
                    <h3 class="text-lg font-semibold">Test Actions:</h3>
                    <button id="test-login" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                        Simulate Login
                    </button>
                    <button id="test-logout" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                        Simulate Logout
                    </button>
                    <button id="toggle-dropdown" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                        Toggle Dropdown
                    </button>
                </div>

                <div class="mt-6">
                    <h3 class="text-lg font-semibold">Expected Behavior:</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Click profile icon → dropdown shows/hides</li>
                        <li>Click "Profile" → navigate to profile.html (overview tab)</li>
                        <li>Click "Account" → navigate to profile.html#account (account tab)</li>
                        <li>Click "Orders" → navigate to profile.html#orders (orders tab)</li>
                        <li>Click "Logout" → log out and redirect to home</li>
                        <li>Click outside dropdown → dropdown closes</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <script>
        // Test script for dropdown functionality
        document.addEventListener('DOMContentLoaded', () => {
            const profileRibbon = document.getElementById('profile-ribbon');
            const profileDropdown = document.getElementById('profile-dropdown');
            const dropdownStatus = document.getElementById('dropdown-status');
            const currentUserInfo = document.getElementById('current-user-info');
            
            // Update status display
            function updateStatus() {
                const isVisible = !profileDropdown.classList.contains('hidden');
                dropdownStatus.textContent = isVisible ? 'Visible' : 'Hidden';
                dropdownStatus.className = isVisible ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold';
            }

            // Profile ribbon click handler
            profileRibbon.addEventListener('click', (e) => {
                e.stopPropagation();
                profileDropdown.classList.toggle('hidden');
                updateStatus();
                console.log('Profile ribbon clicked, dropdown toggled');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!profileRibbon.contains(e.target)) {
                    profileDropdown.classList.add('hidden');
                    updateStatus();
                    console.log('Clicked outside, dropdown closed');
                }
            });

            // Dropdown link handlers
            const dropdownLinks = profileDropdown.querySelectorAll('a');
            dropdownLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    console.log('Dropdown link clicked:', link.href);
                    profileDropdown.classList.add('hidden');
                    updateStatus();
                });
            });

            // Logout button handler
            const logoutBtn = document.getElementById('dropdown-logout-btn');
            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                console.log('Logout clicked');
                profileDropdown.classList.add('hidden');
                updateStatus();
                alert('Logout functionality would be triggered here');
            });

            // Test buttons
            document.getElementById('test-login').addEventListener('click', () => {
                currentUserInfo.textContent = 'test@example.com';
                profileRibbon.style.display = 'flex';
                document.getElementById('login-signup-link').style.display = 'none';
                console.log('Simulated login');
            });

            document.getElementById('test-logout').addEventListener('click', () => {
                currentUserInfo.textContent = 'Not logged in';
                profileRibbon.style.display = 'none';
                document.getElementById('login-signup-link').style.display = 'block';
                profileDropdown.classList.add('hidden');
                updateStatus();
                console.log('Simulated logout');
            });

            document.getElementById('toggle-dropdown').addEventListener('click', () => {
                profileDropdown.classList.toggle('hidden');
                updateStatus();
                console.log('Dropdown toggled manually');
            });

            // Initial status update
            updateStatus();
        });
    </script>
</body>
</html>
